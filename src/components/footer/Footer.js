import React from 'react';
import styled from 'styled-components';
import { up } from 'styled-breakpoints';
import { StaticQuery, Link, graphql } from 'gatsby';
import { Text, Flex, Box } from 'rebass/styled-components';
import { container } from '@utils/mixins';
import { colors } from '@theme';

const Wrapper = styled.footer`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-column-gap: 46px;
  grid-row-gap: 100px;
  ${container({ py: '150px' })};
  ${up('tablet')} {
    grid-template-columns: repeat(4, 1fr);
  }
  li {
    margin-bottom: 0.25rem;
  }
  a {
    color: ${colors.warmGrey};
    text-decoration: none;
    font-size: 14px;
    display: inline-block;
    padding: 0.25rem 0;
  }
`;

const Ours = styled(Flex)`
  justify-content: center;
  align-items: center;
  height: 144px;
  box-shadow: 0 -1px 0 0 rgba(0, 0, 0, 0.05);
`;

const OursLogo = () => (
  <Box width="100px">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="100%"
      viewBox="0 0 96.54 78.4"
    >
      <g
        data-name="Groupe 410"
        transform="translate(-1100.64 -319) translate(-1249.852 -59.705)"
      >
        <ellipse
          cx="21"
          cy="21"
          fill="#0029e7"
          data-name="Ellipse 15"
          rx="21"
          ry="21"
          transform="translate(2380.852 378.705)"
        ></ellipse>
        <ellipse
          cx="13.376"
          cy="13.376"
          fill="#f8f8ff"
          data-name="Ellipse 16"
          rx="13.376"
          ry="13.376"
          transform="translate(2388.476 386.328)"
        ></ellipse>
        <path
          fill="#f33"
          d="M2426.39 430.11l-4.945-3.957a3.511 3.511 0 014.387-5.483l.559.448.56-.448a3.511 3.511 0 014.387 5.483z"
          data-name="Tracé 13806"
          transform="translate(-24.539 -24.413)"
        ></path>
      </g>
      <path
        fill="#404040"
        d="M-50.64 0h-.72v-7.08h4.27v.66h-3.55v2.41h3.3v.66h-3.3zm8.62-2.52h3.07l-1.53-3.72zM-43.07 0h-.84l3.08-7.08h.7L-37.05 0h-.84l-.78-1.86h-3.62zm11.1-.66h1.38a3.182 3.182 0 00.73-.08 1.817 1.817 0 00.59-.245 1.236 1.236 0 00.395-.415 1.176 1.176 0 00.145-.6 1.22 1.22 0 00-.45-1.04 2.166 2.166 0 00-1.32-.34h-1.47zm0-3.32h1.45a2.077 2.077 0 00.515-.065 1.325 1.325 0 00.46-.215 1.173 1.173 0 00.335-.385 1.173 1.173 0 00.13-.575 1.52 1.52 0 00-.045-.31 1.026 1.026 0 00-.2-.4 1.251 1.251 0 00-.455-.345 1.884 1.884 0 00-.81-.145h-1.38zm-.72-3.1h2.11a3.953 3.953 0 01.85.09 2.162 2.162 0 01.73.3 1.554 1.554 0 01.51.55 1.7 1.7 0 01.19.84 1.565 1.565 0 01-.325.995 1.586 1.586 0 01-.925.555v.02a1.707 1.707 0 011.175.525 1.774 1.774 0 01.425 1.245 2.2 2.2 0 01-.085.5 1.7 1.7 0 01-.355.655 2.227 2.227 0 01-.78.565 3.229 3.229 0 01-1.36.24h-2.16zm10.42 3.13h1.28a2.88 2.88 0 00.815-.1 1.514 1.514 0 00.535-.265.967.967 0 00.29-.39 1.294 1.294 0 00.09-.485 1.267 1.267 0 00-.09-.475 1 1 0 00-.29-.395 1.41 1.41 0 00-.535-.265 3.023 3.023 0 00-.815-.1h-1.28zm0 3.95h-.72v-7.08h2.18a2.776 2.776 0 011.7.47 1.663 1.663 0 01.625 1.42 1.769 1.769 0 01-.465 1.245 2 2 0 01-1.345.585L-18.25 0h-.88l-1.94-3.29h-1.2zm9.33 0h-.72v-7.08h.72zm11.15-1.12a2.743 2.743 0 01-.445.51 2.814 2.814 0 01-.605.41 3.45 3.45 0 01-.735.28 3.391 3.391 0 01-.835.1A3.786 3.786 0 01-5.875-.1a3.569 3.569 0 01-1.17-.775A3.556 3.556 0 01-7.82-2.05a3.876 3.876 0 01-.28-1.49 3.876 3.876 0 01.28-1.49 3.556 3.556 0 01.775-1.175 3.569 3.569 0 011.17-.775 3.786 3.786 0 011.465-.28A3.578 3.578 0 01-3.09-7a2.662 2.662 0 011.13.86l-.63.47a1.715 1.715 0 00-.3-.34 2.183 2.183 0 00-.435-.3 2.7 2.7 0 00-.525-.21 2.03 2.03 0 00-.56-.08 2.871 2.871 0 00-1.22.25 2.769 2.769 0 00-.915.67 2.948 2.948 0 00-.575.98 3.41 3.41 0 00-.2 1.165 3.41 3.41 0 00.2 1.165 2.948 2.948 0 00.575.975 2.769 2.769 0 00.915.67 2.871 2.871 0 001.22.25 3.1 3.1 0 00.555-.05 2.305 2.305 0 00.54-.17 2.04 2.04 0 00.5-.325 2.412 2.412 0 00.435-.52zm5.54-1.4h3.07L5.29-6.24zM2.7 0h-.84l3.08-7.08h.7L8.72 0h-.84L7.1-1.86H3.48zm11.97 0h-.72v-6.42h-2.37v-.66h5.46v.66h-2.37zm7.59 0h-.72v-7.08h.72zM33.7-3.54a3.41 3.41 0 00-.2-1.16 2.948 2.948 0 00-.575-.975 2.769 2.769 0 00-.915-.67 2.871 2.871 0 00-1.22-.25 2.871 2.871 0 00-1.22.25 2.769 2.769 0 00-.915.67 2.948 2.948 0 00-.575.975 3.41 3.41 0 00-.2 1.165 3.41 3.41 0 00.2 1.165 2.948 2.948 0 00.575.975 2.769 2.769 0 00.915.67 2.871 2.871 0 001.22.25 2.871 2.871 0 001.22-.25 2.769 2.769 0 00.915-.67 2.948 2.948 0 00.575-.975 3.41 3.41 0 00.2-1.17zm.78 0a3.876 3.876 0 01-.28 1.49 3.556 3.556 0 01-.775 1.175 3.568 3.568 0 01-1.17.775 3.786 3.786 0 01-1.465.28 3.786 3.786 0 01-1.465-.28 3.569 3.569 0 01-1.17-.775 3.556 3.556 0 01-.775-1.175 3.876 3.876 0 01-.28-1.49 3.876 3.876 0 01.28-1.49 3.556 3.556 0 01.775-1.175 3.569 3.569 0 011.17-.775 3.786 3.786 0 011.465-.28 3.786 3.786 0 011.465.28 3.568 3.568 0 011.17.775A3.556 3.556 0 0134.2-5.03a3.876 3.876 0 01.28 1.49zm9.96 2.46h.02v-6h.72V0h-.9l-4.22-6.06h-.02V0h-.72v-7.08h.9zm-85.21 10h4.57v1.14h-3.31v1.86h3.12v1.14h-3.12V16h-1.26zm9.14 0h2.46a5.012 5.012 0 01.985.1 2.522 2.522 0 01.845.325 1.7 1.7 0 01.59.62 2 2 0 01.22.99 1.972 1.972 0 01-.425 1.29 1.823 1.823 0 01-1.215.63L-26.29 16h-1.52l-1.64-3h-.92v3h-1.26zm2.24 3q.27 0 .54-.025a1.658 1.658 0 00.5-.12.845.845 0 00.365-.29.922.922 0 00.14-.545.87.87 0 00-.13-.5.808.808 0 00-.34-.285 1.565 1.565 0 00-.465-.125 4.237 4.237 0 00-.5-.03h-1.09v1.92zm9.75-3h1.09L-15.5 16h-1.44l-.66-1.62h-3.07l-.64 1.62h-1.41zm1.6 4.38l-1.09-2.88-1.11 2.88zm6.73-4.38h1.67l3.43 5.26h.02V8.92h1.26V16h-1.6l-3.5-5.43h-.02V16h-1.26zm16.22 1.66a2.11 2.11 0 00-.755-.56 2.038 2.038 0 00-.735-.14 2.454 2.454 0 00-.995.2 2.277 2.277 0 00-.765.54 2.453 2.453 0 00-.495.805 2.761 2.761 0 00-.175.99 3.044 3.044 0 00.175 1.05 2.466 2.466 0 00.495.83 2.3 2.3 0 00.765.55 2.4 2.4 0 00.995.2 1.828 1.828 0 00.835-.2 2.279 2.279 0 00.755-.655l1.04.74a2.826 2.826 0 01-1.15.955 3.677 3.677 0 01-1.45.305l-.29.42q.22 0 .435.02a1.123 1.123 0 01.39.1.676.676 0 01.28.25.843.843 0 01.1.455.774.774 0 01-.135.46 1 1 0 01-.335.3 1.564 1.564 0 01-.45.16 2.4 2.4 0 01-.47.05 2.137 2.137 0 01-1.06-.28l.22-.46a1.734 1.734 0 00.82.2.927.927 0 00.18-.02.677.677 0 00.185-.065.414.414 0 00.145-.13.346.346 0 00.06-.2.284.284 0 00-.175-.28.805.805 0 00-.335-.08.874.874 0 00-.19.02 1.813 1.813 0 00-.18.05l-.27-.25.51-.75a3.787 3.787 0 01-1.31-.38A3.38 3.38 0 01-.1 13.885a3.991 3.991 0 01-.235-1.4 4.1 4.1 0 01.28-1.545 3.467 3.467 0 01.78-1.18A3.4 3.4 0 011.9 9a4.138 4.138 0 011.51-.26 3.451 3.451 0 011.335.255 3.112 3.112 0 011.145.865zm7.68-1.66h1.09L16.73 16h-1.44l-.66-1.62h-3.07L10.92 16H9.51zm1.6 4.38l-1.09-2.88-1.11 2.88zm6.7-4.38h1.26V16h-1.26zm9.68 1.52a1.162 1.162 0 00-.535-.425 1.868 1.868 0 00-.7-.135 1.787 1.787 0 00-.425.05 1.154 1.154 0 00-.37.16.836.836 0 00-.265.285.823.823 0 00-.1.415.649.649 0 00.25.55 2.458 2.458 0 00.62.33q.37.14.81.27a3.293 3.293 0 01.81.36 2 2 0 01.62.61 1.813 1.813 0 01.25 1.01 2.221 2.221 0 01-.21.995 2.028 2.028 0 01-.565.7 2.443 2.443 0 01-.825.42 3.45 3.45 0 01-.99.14 3.715 3.715 0 01-1.27-.22 2.447 2.447 0 01-1.05-.74l.95-.92a1.589 1.589 0 00.6.545 1.7 1.7 0 00.8.195 1.666 1.666 0 00.44-.06 1.361 1.361 0 00.4-.18.939.939 0 00.29-.305.816.816 0 00.11-.425.74.74 0 00-.25-.6 2.208 2.208 0 00-.62-.355q-.37-.145-.81-.275a3.411 3.411 0 01-.81-.355 1.97 1.97 0 01-.62-.6 1.787 1.787 0 01-.25-1.005 1.907 1.907 0 01.225-.95 2.058 2.058 0 01.59-.665 2.576 2.576 0 01.83-.39 3.585 3.585 0 01.96-.13 3.5 3.5 0 011.085.17 2.515 2.515 0 01.945.56zm5.67-1.52h4.69v1.14H37.5v1.74h3.25v1.14H37.5v1.92h3.61V16h-4.87z"
        data-name="Tracé 14048"
        transform="translate(-1100.64 -319) translate(1152 379)"
      ></path>
    </svg>
  </Box>
);

const Title = ({ children }) => (
  <Text fontFamily="orpheuspro" fontWeight="400" mb="1.5rem">
    {children}
  </Text>
);

const Collections = ({ items }) =>
  items.length > 0 ? (
    <div>
      <Title>Collections</Title>
      <ul>
        {items.map(node => {
          return (
            <li key={node.id}>
              <Link to={`/shop/?collections=${node.id}`}>{node.title}</Link>
            </li>
          );
        })}
      </ul>
    </div>
  ) : null;

const Footer = () => (
  <StaticQuery
    query={graphql`
      query {
        productsGroupByCollection: allSanityProduct(limit: 2000) {
          group(field: collections____id) {
            fieldValue
            totalCount
          }
        }
        collections: allSanityCollection(sort: { fields: title, order: ASC }) {
          nodes {
            _id
            id
            title
            thumbnail {
              asset {
                fixed(width: 320) {
                  ...GatsbySanityImageFixed
                }
              }
              alt
            }
          }
        }
      }
    `}
    render={data => {
      return (
        <>
          <Wrapper>
            <Collections
              items={data.collections.nodes.filter(collection =>
                data.productsGroupByCollection.group
                  .map(item => item.fieldValue)
                  .includes(collection._id)
              )}
            ></Collections>
            <div>
              <Title>Entreprise</Title>
              <ul>
                <li>
                  <Link to="/brand">La marque</Link>
                </li>
                <li>
                  <Link to="/contact">Contactez-nous</Link>
                </li>
                <li>
                  <Link to="/cgu">CGV</Link>
                </li>
                <li>
                  <Link to="/legal">Mentions légales</Link>
                </li>
              </ul>
            </div>
            <div>
              <Title>Partenaires</Title>
              <ul>
                <li>
                  <Link to="/outlets">Nos points de vente</Link>
                </li>
                {/* <li>
                <Link to="/dealer-acces">Accès revendeur</Link>
              </li> */}
                {/* <li>
                  <Link to="/press">Presse</Link>
                </li>
                <li>
                  <Link to="/lookbook">Lookbook 19/20</Link>
                </li> */}
              </ul>
            </div>
            <div>
              <Title>Suivez-nous</Title>
              <ul>
                <li>
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.instagram.com/demiselbijoux"
                  >
                    Instagram
                  </a>
                </li>
                <li>
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.facebook.com/demiselbijoux/"
                  >
                    Facebook
                  </a>
                </li>
              </ul>
            </div>
          </Wrapper>
          <Ours>
            <OursLogo />
          </Ours>
        </>
      );
    }}
  />
);

export default Footer;
